<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>먹스타그램 메인 페이지</title>
  <!--부트 스트랩 적용-->
  <link th:href="@{/css/bootstrap.min.css}"
        href="../css/bootstrap.min.css" rel="stylesheet">
  <!--css 적용-->
  <link rel="stylesheet" type="text/css" href="../css/boards/board/muckstar_main_style.css" th:href="@{/muckstar_main_style.css}">
</head>

<body>
<header style="position: relative;">
  <img src="/image/main_img/logo2.PNG" class="logo"
       style="position: absolute; z-index: 3; width: 170px; height: 90px; left: 2.5%; top: 10%;" id="logo2">

  <div class="px-3 py-2 bg-dark text-white">
    <div class="container">
      <div class="d-flex flex-wrap align-items-center justify-content-center justify-content-lg-start">
        <img src="/image/main_img/muckstar_icon.PNG" width="50px" height="50px">
        <a href="/boards/recommendBoard" class="navbar-brand"><h4 class="thema">&nbsp;&nbsp;먹스타그램</h4></a>

        <ul class="nav col-12 col-lg-auto my-2 justify-content-center my-md-0 text-small">
          <li>
            <img src="/image/main_img/home_icon.PNG" width="45px" height="40px"
                 style="margin-left: 151px; margin-top: 10px;">
            <a href="/" class="nav-link text-white">
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;메인
            </a>
          </li>
          <li>
            <img src="/image/main_img/write_icon.PNG" width="50px" height="40px"
                 style="margin-left: 102px; margin-top: 10px;">
            <a href="/boards/freeBoard" class="nav-link text-white">
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;자유게시판
            </a>
          </li>
          <li>
            <img src="/image/main_img/write_icon.PNG" width="50px" height="40px"
                 style="margin-left: 90px; margin-top: 10px;">
            <a href="/boards/recommendBoard" class="nav-link text-white">
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;추천게시판
            </a>
          </li>
          <li>
            <img src="/image/main_img/menu_recommend_icon.PNG" width="50px" height="40px"
                 style="margin-left: 75px; margin-top: 10px;">
            <a href="menu_recommend.html" class="nav-link text-white">
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;메뉴추천
            </a>
          </li>
          <li>
            <img src="/image/main_img/chat_icon.PNG" width="50px" height="40px"
                 style="margin-left: 65px; margin-top: 10px;">
            <a href="chat.html" class="nav-link text-white">
              &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;채팅방&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
            </a>
          </li>

          <li>
            <h5 th:if="${session.loginMember != null}"
                th:text="${session.loginMember.name}+ '님 접속중'"
                id="userName" style="font-size : 13px; margin-top: 20px;"></h5>

            <br/>

            <form th:action="@{/members/logout}" method="post">
              <button th:if="${session.loginMember != null}"
                      type="submit" class="btn btn-primary" id="logout"
                      style="width: 90px; height: 35px; position :absolute; top: 56%;"
                      th:onclick="@{/members/logout}">로그아웃
              </button>
            </form>

            <button th:if="${session.loginMember == null}"
                    type="submit" class="btn btn-primary"
                    style="width: 80px; height: 35px; position :absolute; top: 56%;" id="login"
                    th:onclick="|location.href='@{/members/login}'|">로그인
            </button>
          </li>
        </ul>
      </div>
    </div>
  </div>
</header>

<div style="position: relative; width: 70vw; height: 80vh;">

    <!--검색-->
    <div style="position: absolute; top: 3%; left: 47%;">
      <form th:action="@{/boards/muckstarBoard}" method="get">
        <div class="row">
          <div class="col-md-1" style="width: 15vw;">
            <input type="text" name="writerSearchKeyword" class="form-control" placeholder="글쓴이"/>
          </div>

          <div class="col-md-1" style="width: 5vw;">
            <button type="submit" class="btn btn-secondary">검색</button>
          </div>

          <div class="col-md-1" style="width: 6vw;">
            <button class="btn btn-danger" id="write"
                    th:onclick="|location.href='@{/boards/muckstarBoard/upload}'|"
                    type="button">글 작성
            </button>
          </div>
        </div>
      </form>
    </div>

    <div class="main" style="position: absolute; width: 70vw;">

      <div class="infinite-container" id="infinite-container"
           style="position: absolute; width: 70vw; height: 90vh;">

        <div th:each="image : ${boardFiles}"
             class="card" id="card" style="margin-top: 10%; left: 40%; width: 40vw; height: 70vh margin-top: 10%;">
          <input class="cursorBoardId" th:id="${image.board.id}" style="display: none;" th:name="${image.board.id}"/>

          <img th:src="@{|/imageFileUpload/${image.storedFileName}|}"
               style="max-width: 100%; height: 90%;">

          <div class="input-group" style="margin-left: 5%;">
            <button class="btn btnEvent" id="like_btn" style="width: 3vw; height: 3vh;"
                    type="button">
              <img src="/image/muckstargram_img/favorite_icon.PNG" style="width: 3vw; height: 5vh;">
            </button>

            <h4 class="like" style="font-weight: 500; font-size: 250%; margin-left: 5%; margin-top: 1.5%;" th:text="${image.board.likeCount}"></h4>
          </div>

          <br>
        </div>
      </div>

    </div>

  <div class="article-list" id="article-list"></div>
  <ul class="article-list__pagination article-list__pagination--inactive" id="article-list-pagination"></ul>
</div>


  <!--jquery-->
  <script
  src="https://code.jquery.com/jquery-3.6.0.min.js"
  integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4="
  crossorigin="anonymous">
  </script>


<!--<script type="text/javascript">-->
<!--//페이지가 처음 로딩될 때 1page를 보여주기 때문에 초기값을 1로 지정한다.-->
<!--let currentPage=1;-->
<!--//현재 페이지가 로딩중인지 여부를 저장할 변수이다.-->
<!--let isLoading=false;-->

<!--//웹브라우저의 창을 스크롤 할 때 마다 호출되는 함수 등록-->
<!--$(window).on("scroll",function(){-->
<!--    //위로 스크롤된 길이-->
<!--    let scrollTop=$(window).scrollTop();-->
<!--    //웹브라우저의 창의 높이-->
<!--    let windowHeight=$(window).height();-->
<!--    //문서 전체의 높이-->
<!--    let documentHeight=$(document).height();-->
<!--    //바닥까지 스크롤 되었는 지 여부를 알아낸다.-->
<!--    let isBottom=scrollTop+windowHeight + 10 >= documentHeight;-->

<!--    if(isBottom){-->
<!--        //만일 현재 마지막 페이지라면-->
<!--        if(currentPage == ${totalPageCount} || isLoading){-->
<!--            return; //함수를 여기서 끝낸다.-->
<!--        }-->
<!--        //현재 로딩 중이라고 표시한다.-->
<!--        isLoading=true;-->
<!--        //로딩바를 띄우고-->
<!--        $(".back-drop").show();-->
<!--        //요청할 페이지 번호를 1 증가시킨다.-->
<!--        currentPage++;-->
<!--        //추가로 받아올 페이지를 서버에 ajax 요청을 하고-->
<!--        console.log("inscroll"+currentPage);-->
<!--        GetList(currentPage);-->

<!--    };-->
<!--});-->
<!--</script>-->

<!--<script>-->
<!--const GetList = function(currentPage){-->
<!--    console.log("inGetList"+currentPage);-->

<!--    // 무한 스크롤-->
<!--    $.ajax({-->
<!--        url:"boards/muckstarBoard",-->
<!--        method:"GET",-->
<!--        // 검색기능이 있는 경우 condition과 keyword를 함께 넘겨줘야한다. 안그러면 검색결과만 나와야하는데 다른것들이 덧붙여져 나온다.-->
<!--        data:"pageNum="+currentPage+"&condition=${condition}&keyword=${keyword}",-->
<!--        // 내용이 data로 들어온다.-->
<!--        success:function(data){-->
<!--            console.log(data);-->
<!--            // 응답된 문자열은 html 형식이다.(picture/ajax_page.jsp에 응답내용이 있다.)-->
<!--            // 해당 문자열을 .card-list-container  div에 html로 해석하라고 추가한다.-->
<!--            $(".card").append(data);-->
<!--            console.log("ajax");-->
<!--        }-->
<!--    });-->
<!--}-->

<!--</script>-->

<!--<script type="text/javascript">-->
<!--var page = 1;-->

<!--$(window).scroll(function() {-->
<!--    if ($(window).scrollTop() == $(document).height() - $(window).height()) {-->
<!--      console.log(++page);-->

<!--      $("#card").append("<h1>Page " + page + "</h1>So<BR/>MANY<BR/>BRS<BR/>YEAHHH~<BR/>So<BR/>MANY<BR/>BRS<BR/>YEAHHH~");-->
<!--    }-->
<!--});-->
<!--</script>-->

<script src="/js/muckstar.js"></script>

</body>
</html>